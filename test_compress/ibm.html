<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="ibm.js"></script>
</head>

<body>
  <script>
    //ibm_k
    function comp(cur,prev,prop){
      return ((((cur[prop]-prev[prop])).toFixed(2))*100).toFixed(0)
    }
    const init = ibm_k[0];

    let result = [init];

    for (let i = 1; i < ibm_k.length; i++) {
      let one = ibm_k[i];
      let prev=ibm_k[i-1];
      //let date = one.date;      
      let open = comp(one,prev,'open'),
        high = comp(one,prev,'high'),
        low = comp(one,prev,'low'),
        close = comp(one,prev,'close'),
        volume = (one.volume-prev.volume)/100;
        if(volume>1000){
          volume=0;
          ibm_k[i].volume=0;
        }
        
      result.push([open,high,low,close,volume].join(','));
      result.push('|')
    }
    
    console.log(result.join(''));
  </script>
</body>

</html>